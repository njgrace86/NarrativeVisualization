<!Doctype html>

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>HTML 5 Boilerplate</title>
        <style>
            .bar{
                fill: steelblue;
            }
        </style>

    </head>
    <body onload='init()'>
    <h1>Chart</h1>
        <!--import d3 -->
        <script src="//d3js.org/d3.v7.min.js"></script>

        <!--div for visualization-->
        <div id="narrative_viz"></div>

        <!--specify visualization-->
        <script>

            // Set margins
            var margin = {top: 50, bottom: 50, left: 50, right: 50};

            // Set canvas dimensions
            var width = 1000 - margin.left - margin.right;
            var height = 1000 - margin.top - margin.bottom; 

            // Import data
            async function init(){
                const data = await d3.csv("/CrochetData.csv");

                // Format data grouping by age, age/experience, age/session
                const age_label = (d3.permute(Array.from(d3.group(data, (d) => d.Age).keys()), [1,3,2,4,5,0,6]));
                const exp_label = (d3.permute(Array.from(d3.group(data, (d) => d.YearExperience).keys()), [2,1,5,4,0,3]));
                const time_lable = (d3.permute(Array.from(d3.group(data, (d) => d.SessionTime).keys()), [3,0,2,1]));

                const age_range = d3.rollup(data, (D) => D.length, (d) => d.Age);
                const age_exp = d3.rollup(data, (D) => D.length, (d) => d.Age, (d) => d.YearExperience);
                const age_time = d3.rollup(data, (D) => D.length, (d) => d.Age, (d) => d.SessionTime);

                var max_age_count = Math.max(...Array.from(age_range.values()))
        
                // Define svg
                var svg = d3.select("#narrative_viz")
                    .append("svg")
                        .attr("width", width + margin.left + margin.right)
                        .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");            

                // Define X axis
                var x = d3.scaleBand()
                    .domain([0,1,2,3,4,5,6])
                    .range([0, width])

                svg.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x));

                var y = d3.scaleLinear()
                    .domain([max_age_count + 10])
                    .range([height, 0]);
                svg.append("g")
                    .call(d3.axisLeft(y));           
                    
                }
        </script>
    </body>
</html>